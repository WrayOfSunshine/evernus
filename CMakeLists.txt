cmake_minimum_required(VERSION 2.8.11)

project(Evernus)

set(CMAKE_INCLUDE_CURRENT_DIR ON)
set(PROJECT_NAME "evernus")

find_package(Qt5Network REQUIRED)
find_package(Qt5PrintSupport REQUIRED)
find_package(Qt5Sql REQUIRED)
find_package(Qt5Xml REQUIRED)
find_package(Qt5XmlPatterns REQUIRED)
find_package(Qt5Widgets REQUIRED)
find_package(Boost REQUIRED)

if(UNIX)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -std=c++1y -stdlib=libc++ -g")
elseif(WIN32)
    set(ADDITIONAL_SRC "evernus.rc")
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /W3")
endif()

qt5_wrap_cpp(
    MOC_FILES
    ActiveTasksDialog.h
    APIInterface.h
    APIManager.h
    AssetsImportPreferencesWidget.h
    AssetsWidget.h
    ButtonWithTimer.h
    CharacterBoundWidget.h
    CharacterManagerDialog.h
    CharacterModel.h
    CharacterImportPreferencesWidget.h
    CharacterWidget.h
    DateFilteredPlotWidget.h
    EvernusApplication.h
    FileDownload.h
    ItemPriceImporter.h
    MainWindow.h
    MarginToolDialog.h
    MarketLogItemPriceImporter.h
    MarketLogItemPriceImporterThread.h
    MenuBarWidget.h
    NetworkPreferencesWidget.h
    PathPreferencesWidget.h
    PreferencesDialog.h
    PricePreferencesWidget.h
    qcustomplot.h
    StatisticsWidget.h
    WalletPreferencesWidget.h
)

qt5_add_resources(
    RCC_FILES
    evernus.qrc
)

include_directories(${Boost_INCLUDE_DIRS})

add_executable(
    ${PROJECT_NAME}
    WIN32
    ActiveTasksDialog.cpp
    ActiveTasksDialog.h
    APIDomParser.h
    APIInterface.cpp
    APIInterface.h
    APIManager.cpp
    APIManager.h
    APIResponseCache.cpp
    APIResponseCache.h
    APIXmlReceiver.h
    AssetList.cpp
    AssetList.h
    AssetListRepository.cpp
    AssetListRepository.h
    AssetListXmlReceiver.cpp
    AssetListXmlReceiver.h
    AssetModel.cpp
    AssetModel.h
    AssetProvider.h
    AssetsImportPreferencesWidget.cpp
    AssetsImportPreferencesWidget.h
    AssetsWidget.cpp
    AssetsWidget.h
    AssetValueSnapshot.cpp
    AssetValueSnapshot.h
    AssetValueSnapshotRepository.cpp
    AssetValueSnapshotRepository.h
    ButtonWithTimer.cpp
    ButtonWithTimer.h
    CachedAssetList.cpp
    CachedAssetList.h
    CachedAssetListRepository.cpp
    CachedAssetListRepository.h
    CachedCharacter.cpp
    CachedCharacter.h
    CachedCharacterList.cpp
    CachedCharacterList.h
    CachedCharacterListRepository.cpp
    CachedCharacterListRepository.h
    CachedCharacterRepository.cpp
    CachedCharacterRepository.h
    CachedConquerableStation.cpp
    CachedConquerableStation.h
    CachedConquerableStationList.cpp
    CachedConquerableStationList.h
    CachedConquerableStationListRepository.cpp
    CachedConquerableStationListRepository.h
    CachedConquerableStationRepository.cpp
    CachedConquerableStationRepository.h
    CachedEntity.cpp
    CachedEntity.h
    CachedItem.cpp
    CachedItem.h
    CachedItemRepository.cpp
    CachedItemRepository.h
    CachedWalletJournalEntry.cpp
    CachedWalletJournalEntry.h
    CachedWalletJournalEntryRepository.cpp
    CachedWalletJournalEntryRepository.h
    CacheRepository.h
    Character.cpp
    Character.h
    CharacterBoundWidget.cpp
    CharacterBoundWidget.h
    CharacterData.h
    CharacterDomParser.h
    CharacterImportPreferencesWidget.cpp
    CharacterImportPreferencesWidget.h
    CharacterListXmlReceiver.cpp
    CharacterListXmlReceiver.h
    CharacterManagerDialog.cpp
    CharacterManagerDialog.h
    CharacterModel.cpp
    CharacterModel.h
    CharacterRepository.cpp
    CharacterRepository.h
    CharacterWidget.cpp
    CharacterWidget.h
    ConquerableStation.cpp
    ConquerableStation.h
    ConquerableStationList.h
    ConquerableStationListXmlReceiver.cpp
    ConquerableStationListXmlReceiver.h
    ConquerableStationRepository.cpp
    ConquerableStationRepository.h
    DatabaseUtils.cpp
    DatabaseUtils.h
    DateFilteredPlotWidget.cpp
    DateFilteredPlotWidget.h
    Entity.h
    EveDataProvider.h
    EveMarketDataItemPriceImporter.cpp
    EveMarketDataItemPriceImporter.h
    EveMarketDataItemPriceImporterXmlReceiver.cpp
    EveMarketDataItemPriceImporterXmlReceiver.h
    EvernusApplication.cpp
    EvernusApplication.h
    EveType.cpp
    EveType.h
    EveTypeRepository.cpp
    EveTypeRepository.h
    FileDownload.cpp
    FileDownload.h
    ImportSettings.h
    Item.cpp
    Item.h
    ItemData.h
    ItemPrice.cpp
    ItemPrice.h
    ItemPriceImporter.h
    ItemPriceImporterNames.h
    ItemPriceImporterRegistry.h
    ItemPriceRepository.cpp
    ItemPriceRepository.h
    ItemRepository.cpp
    ItemRepository.h
    Key.cpp
    Key.h
    KeyEditDialog.cpp
    KeyEditDialog.h
    KeyRepository.cpp
    KeyRepository.h
    main.cpp
    MainWindow.cpp
    MainWindow.h
    MarginToolDialog.cpp
    MarginToolDialog.h
    MarginToolSettings.h
    MarketGroup.cpp
    MarketGroup.h
    MarketGroupRepository.cpp
    MarketGroupRepository.h
    MarketLogItemPriceImporter.cpp
    MarketLogItemPriceImporter.h
    MarketLogItemPriceImporterThread.cpp
    MarketLogItemPriceImporterThread.h
    MenuBarWidget.cpp
    MenuBarWidget.h
    NetworkPreferencesWidget.cpp
    NetworkPreferencesWidget.h
    NetworkSettings.h
    PathPreferencesWidget.cpp
    PathPreferencesWidget.h
    PathSettings.h
    PathUtils.cpp
    PathUtils.h
    PreferencesDialog.cpp
    PreferencesDialog.h
    PricePreferencesWidget.cpp
    PricePreferencesWidget.h
    PriceSettings.h
    qcustomplot.cpp
    qcustomplot.h
    RefType.cpp
    RefType.h
    RefTypeRepository.cpp
    RefTypeRepository.h
    RefTypeXmlReceiver.cpp
    RefTypeXmlReceiver.h
    Repository.h
    SimpleCrypt.cpp
    SimpleCrypt.h
    StatisticsWidget.cpp
    StatisticsWidget.h
    TaskConstants.h
    UISettings.h
    WalletJournal.h
    WalletJournalData.h
    WalletJournalEntry.cpp
    WalletJournalEntry.h
    WalletJournalEntryRepository.cpp
    WalletJournalEntryRepository.h
    WalletJournalWidget.cpp
    WalletJournalWidget.h
    WalletJournalXmlReceiver.cpp
    WalletJournalXmlReceiver.h
    WalletPreferencesWidget.cpp
    WalletPreferencesWidget.h
    WalletSettings.h
    WalletSnapshot.cpp
    WalletSnapshot.h
    WalletSnapshotRepository.cpp
    WalletSnapshotRepository.h
    ${MOC_FILES}
    ${RCC_FILES}
    ${ADDITIONAL_SRC}
)

if(WIN32)
    # cmake bug
    set_target_properties(${PROJECT_NAME} PROPERTIES LINK_FLAGS "${LINK_FLAGS} /machine:x64")
endif()

target_link_libraries(
    ${PROJECT_NAME}
    ${Boost_LIBRARIES}
    Qt5::Network
    Qt5::PrintSupport
    Qt5::Sql
    Qt5::Xml
    Qt5::XmlPatterns
    Qt5::Widgets
)
